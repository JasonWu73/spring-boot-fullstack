import{c as S,u as v,a as F,b as E,d as N,j as e,N as m,B as R,R as L,e as u}from"./index-2df15143.js";import{z as r,t as T}from"./index-baf8e82b.js";import{u as k,C as A,a as D,b as I,c as P,d as U,F as _,e as p}from"./CustomFormField-3e2fddec.js";import{u as B}from"./use-title-0288608e.js";import{e as h}from"./rsa-fd848fa5.js";/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=S("ShieldPlus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M12 15V7",key:"1ycneb"}]]),V="/admin",z=r.object({username:r.string().min(1,"必须输入用户名"),password:r.string().min(1,"必须输入密码")}),W={username:"",password:""};function G(){var i,l,c;B("登录");const t=k({resolver:T(z),defaultValues:W}),x=v(),{auth:f,requestApi:j,setAuth:g}=F(),{loading:o,fetchData:w}=E(j),{toast:b}=N(),n=((i=x.state)==null?void 0:i.from)||V;if(f)return e.jsx(m,{to:n,replace:!0});async function y(s,a){return await w({url:"/api/v1/auth/login",method:"POST",bodyData:{username:h(u,s),password:h(u,a)}})}async function C(s){const{data:a,error:d}=await y(s.username,s.password);if(d){b({title:"登录失败",description:d,variant:"destructive"});return}return g(a),e.jsx(m,{to:n,replace:!0})}return e.jsxs(A,{className:"mx-auto mt-8 w-96 md:w-[22rem] lg:mt-24 lg:w-[30rem]",children:[e.jsxs(D,{children:[e.jsx(I,{children:"登录"}),e.jsxs(P,{className:"flex items-center text-green-500 dark:text-green-600",children:[e.jsx(M,{className:"mr-1 h-4 w-4"}),"用户名和密码进行加密传输，且不会被保存在本地"]})]}),e.jsx(U,{children:e.jsx(_,{...t,children:e.jsxs("form",{onSubmit:t.handleSubmit(C),autoComplete:"off",className:"flex flex-col gap-4",children:[e.jsx(p,{control:t.control,name:"username",type:"text",label:"用户名",labelWidth:100,placeholder:"用户名",isError:(l=t.getFieldState("username"))==null?void 0:l.invalid}),e.jsx(p,{control:t.control,name:"password",type:"password",label:"密码",labelWidth:100,placeholder:"密码",isError:(c=t.getFieldState("password"))==null?void 0:c.invalid}),e.jsxs(R,{type:"submit",disabled:o,children:[o&&e.jsx(L,{className:"mr-2 h-4 w-4 animate-spin"}),"登录"]})]})})})]})}export{G as default};
