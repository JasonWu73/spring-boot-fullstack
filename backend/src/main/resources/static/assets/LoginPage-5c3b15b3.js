import{u as j,a as b,R as u,b as R,j as e,N as w,B as E,c as S}from"./index-132372d4.js";import{t as C,z as o}from"./index-8deb8405.js";import{u as F,C as N,a as L,b as T,c as v,d as A,F as D,e as m}from"./CustomFormField-e959eb86.js";import{u as P,a as U}from"./use-title-f4fa0656.js";const W="/admin",y="jissetts",I="ePawWgrnZR8L",B=o.object({username:o.string().min(1,"必须输入用户名"),password:o.string().min(1,"必须输入密码")});function V(){var i,l,c;P("登录");const s=F({resolver:C(B),defaultValues:{username:y,password:I}}),{toast:t,dismiss:p}=j(),{auth:f,error:a,loading:n,login:x}=b(),r=u.useRef();_(a,t),U(()=>{s.reset(),p(),r.current&&r.current()});const h=((i=R().state)==null?void 0:i.from)||W;if(f)return e.jsx(w,{to:h,replace:!0});function g(d){r.current=x(d.username,d.password)}return e.jsxs(N,{className:"mx-auto mt-8 w-96 border-slate-200 bg-slate-200 md:w-[22rem] lg:w-[30rem]",children:[e.jsxs(L,{children:[e.jsx(T,{children:"登录"}),a&&e.jsx(v,{className:"text-red-500 dark:text-red-600",children:a})]}),e.jsx(A,{children:e.jsx(D,{...s,children:e.jsxs("form",{onSubmit:s.handleSubmit(g),className:"flex flex-col gap-4",children:[e.jsx(m,{control:s.control,name:"username",type:"text",label:"用户名",labelWidth:100,placeholder:"用户名",isError:(l=s.getFieldState("username"))==null?void 0:l.invalid}),e.jsx(m,{control:s.control,name:"password",type:"password",label:"密码",labelWidth:100,placeholder:"密码",isError:(c=s.getFieldState("password"))==null?void 0:c.invalid}),e.jsxs(E,{type:"submit",disabled:n,children:[n&&e.jsx(S,{className:"mr-2 h-4 w-4 animate-spin"}),"登录"]})]})})})]})}function _(s,t){u.useEffect(()=>{s&&t({title:"登录失败",description:s,variant:"destructive"})},[s,t])}export{V as default};
