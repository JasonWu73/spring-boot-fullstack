import{c as w,u as y,a as C,b as v,d as S,j as e,N as m,B as E,R as F,s as N,r as L,P as u}from"./index-f29c37fe.js";import{t as P,z as r}from"./index-a1d6eb7d.js";import{u as R,C as T,a as k,b as D,c as I,d as A,F as U,e as p}from"./CustomFormField-a6762e0b.js";import{u as B}from"./use-title-bfe6ef72.js";import{e as h}from"./rsa-fd848fa5.js";/**
 * @license lucide-react v0.293.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=w("ShieldPlus",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M12 15V7",key:"1ycneb"}]]),V="/admin",_=r.object({username:r.string().min(1,"必须输入用户名"),password:r.string().min(1,"必须输入密码")}),q={username:"",password:""};function Y(){var i,l,c;B("登录");const a=R({resolver:P(_),defaultValues:q}),x=y(),{loading:o,requestData:f}=C(L),{toast:j}=v(),n=((i=x.state)==null?void 0:i.from)||V;if(S.value)return e.jsx(m,{to:n,replace:!0});async function g(s,t){return await f({url:"/api/v1/auth/login",method:"POST",bodyData:{username:h(u,s),password:h(u,t)}})}async function b(s){const{data:t,error:d}=await g(s.username,s.password);if(d){j({title:"登录失败",description:d,variant:"destructive"});return}return t&&N(t),e.jsx(m,{to:n,replace:!0})}return e.jsxs(T,{className:"mx-auto mt-8 max-w-md lg:mt-24",children:[e.jsxs(k,{children:[e.jsx(D,{children:"登录"}),e.jsxs(I,{className:"flex items-center text-green-500 dark:text-green-600",children:[e.jsx(M,{className:"mr-1 h-4 w-4"}),"用户名和密码进行加密传输，且不会被保存在本地"]})]}),e.jsx(A,{children:e.jsx(U,{...a,children:e.jsxs("form",{onSubmit:a.handleSubmit(b),autoComplete:"off",className:"flex flex-col gap-4",children:[e.jsx(p,{control:a.control,name:"username",type:"text",label:"用户名",labelWidth:100,placeholder:"用户名",isError:(l=a.getFieldState("username"))==null?void 0:l.invalid}),e.jsx(p,{control:a.control,name:"password",type:"password",label:"密码",labelWidth:100,placeholder:"密码",isError:(c=a.getFieldState("password"))==null?void 0:c.invalid}),e.jsxs(E,{type:"submit",disabled:o,children:[o&&e.jsx(F,{className:"mr-2 h-4 w-4 animate-spin"}),"登录"]})]})})})]})}export{Y as default};
